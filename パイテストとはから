# pytestå®Œå…¨ãƒã‚¹ã‚¿ãƒ¼ï¼šæ–°äººã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ

> ğŸ“¥ **ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’ä¿å­˜ã—ã¦ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ä½¿ãŠã†ï¼**  
> ãƒ–ãƒ©ã‚¦ã‚¶ã®ã€Œå°åˆ·ã€â†’ã€ŒPDFã¨ã—ã¦ä¿å­˜ã€ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½

---

## ğŸ“š ç›®æ¬¡

1. [pytestã¨ã¯ï¼Ÿ](#pytestã¨ã¯)
2. [ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼†ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
3. [åŸºæœ¬çš„ãªæ›¸ãæ–¹](#åŸºæœ¬çš„ãªæ›¸ãæ–¹)
4. [Assertï¼ˆæ¤œè¨¼ï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³é›†](#assertãƒ‘ã‚¿ãƒ¼ãƒ³é›†)
5. [ä¾‹å¤–ãƒ†ã‚¹ãƒˆ](#ä¾‹å¤–ãƒ†ã‚¹ãƒˆ)
6. [ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ï¼ˆå‰å‡¦ç†ãƒ»å¾Œå‡¦ç†ï¼‰](#ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£)
7. [ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ãƒ†ã‚¹ãƒˆ](#ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ãƒ†ã‚¹ãƒˆ)
8. [ãƒãƒ¼ã‚«ãƒ¼ï¼ˆãƒ†ã‚¹ãƒˆã®åˆ†é¡ï¼‰](#ãƒãƒ¼ã‚«ãƒ¼)
9. [ãƒ¢ãƒƒã‚¯ãƒ»ãƒ‘ãƒƒãƒ](#ãƒ¢ãƒƒã‚¯ãƒ‘ãƒƒãƒ)
10. [å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰å®Œå…¨ç‰ˆ](#å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰)
11. [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ](#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ)
12. [å®Ÿå‹™ã§ã‚ˆãä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³](#å®Ÿå‹™ãƒ‘ã‚¿ãƒ¼ãƒ³)
13. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## ğŸ“– pytestã¨ã¯ï¼Ÿ

**pytest**ã¯ã€Pythonã§æœ€ã‚‚äººæ°—ã®ã‚ã‚‹ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚

### ãªãœpytestã‚’ä½¿ã†ã®ã‹ï¼Ÿ

```python
# âŒ æ‰‹å‹•ãƒ†ã‚¹ãƒˆï¼ˆéåŠ¹ç‡ï¼‰
def add(a, b):
    return a + b

# æ¯å›æ‰‹å‹•ã§ç¢ºèª...
print(add(2, 3))  # 5
print(add(-1, 1))  # 0
# çµæœã‚’ç›®ã§ç¢ºèª... ğŸ˜“
```

```python
# âœ… pytestã§è‡ªå‹•ãƒ†ã‚¹ãƒˆï¼ˆåŠ¹ç‡çš„ï¼‰
def test_add():
    """è‡ªå‹•ã§æ¤œè¨¼ã—ã¦ãã‚Œã‚‹"""
    assert add(2, 3) == 5
    assert add(-1, 1) == 0
# ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ pytest å®Ÿè¡Œ â†’ è‡ªå‹•ã§å…¨éƒ¨ãƒã‚§ãƒƒã‚¯ï¼ ğŸ‰
```

### pytestã®åˆ©ç‚¹

- âœ… ã‚·ãƒ³ãƒ—ãƒ«ãªæ›¸ãæ–¹ï¼ˆ`assert`ã ã‘ï¼‰
- âœ… è‡ªå‹•ã§ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡º
- âœ… è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ
- âœ… è±Šå¯Œãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³
- âœ… CI/CDï¼ˆè‡ªå‹•ãƒ†ã‚¹ãƒˆï¼‰ã«çµ„ã¿è¾¼ã¿ã‚„ã™ã„

---

## âš™ï¸ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼†ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# pytestã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pytest

# ã‚ˆãä½¿ã†ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚‚ä¸€ç·’ã«
pip install pytest pytest-cov pytest-mock

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
pytest --version
```

### 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
my_project/
â”œâ”€â”€ src/                    # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ calculator.py
â”œâ”€â”€ tests/                  # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_calculator.py
â”œâ”€â”€ pytest.ini              # pytestè¨­å®š
â””â”€â”€ requirements.txt        # ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
```

### 3. requirements.txt

```text
pytest==7.4.3
pytest-cov==4.1.0
pytest-mock==3.12.0
```

```bash
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt
```

### 4. pytest.iniï¼ˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

```ini
[pytest]
# ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¿ãƒ¼ãƒ³
python_files = test_*.py *_test.py

# ãƒ†ã‚¹ãƒˆé–¢æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³
python_functions = test_*

# ãƒ†ã‚¹ãƒˆã‚’æ¢ã™ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
testpaths = tests

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³
addopts = 
    -v                    # è©³ç´°è¡¨ç¤º
    --strict-markers      # æœªå®šç¾©ãƒãƒ¼ã‚«ãƒ¼ã§ã‚¨ãƒ©ãƒ¼
    --color=yes           # è‰²ä»˜ãå‡ºåŠ›
    --tb=short            # ãƒˆãƒ¬ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚’çŸ­ã

# ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ã‚«ãƒ¼å®šç¾©
markers =
    slow: å®Ÿè¡Œã«æ™‚é–“ãŒã‹ã‹ã‚‹ãƒ†ã‚¹ãƒˆ
    integration: çµ±åˆãƒ†ã‚¹ãƒˆ
    unit: å˜ä½“ãƒ†ã‚¹ãƒˆ
    smoke: ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆ
```

---

## ğŸ“ åŸºæœ¬çš„ãªæ›¸ãæ–¹

### æœ€å°é™ã®ãƒ†ã‚¹ãƒˆ

```python
# tests/test_basic.py

def test_simple():
    """æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ†ã‚¹ãƒˆ"""
    # assert ã§æ¤œè¨¼ã™ã‚‹ã ã‘
    assert 1 + 1 == 2
```

```bash
# å®Ÿè¡Œ
pytest tests/test_basic.py
```

### ãƒ†ã‚¹ãƒˆé–¢æ•°ã®å‘½åè¦å‰‡

```python
# âœ… è‰¯ã„ä¾‹ï¼ˆè‡ªå‹•æ¤œå‡ºã•ã‚Œã‚‹ï¼‰
def test_add():
    pass

def test_add_positive_numbers():
    pass

def test_user_creation():
    pass

# âŒ æ‚ªã„ä¾‹ï¼ˆæ¤œå‡ºã•ã‚Œãªã„ï¼‰
def add_test():  # test_ ã§å§‹ã¾ã£ã¦ã„ãªã„
    pass

def check_add():  # test_ ã§å§‹ã¾ã£ã¦ã„ãªã„
    pass
```

### åŸºæœ¬æ§‹é€ 

```python
# tests/test_calculator.py

# ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
from calculator import add, subtract

# ãƒ†ã‚¹ãƒˆé–¢æ•°ï¼ˆtest_ ã§å§‹ã‚ã‚‹ï¼‰
def test_add():
    """è¶³ã—ç®—ã®ãƒ†ã‚¹ãƒˆ"""
    # å®Ÿè¡Œ
    result = add(2, 3)
    # æ¤œè¨¼
    assert result == 5

def test_subtract():
    """å¼•ãç®—ã®ãƒ†ã‚¹ãƒˆ"""
    result = subtract(5, 3)
    assert result == 2
```

---

## âœ“ Assertãƒ‘ã‚¿ãƒ¼ãƒ³é›†

### åŸºæœ¬çš„ãªassert

```python
def test_basic_assertions():
    """åŸºæœ¬çš„ãªæ¤œè¨¼ãƒ‘ã‚¿ãƒ¼ãƒ³"""
    
    # ç­‰ã—ã„
    assert 1 + 1 == 2
    
    # ç­‰ã—ããªã„
    assert 1 + 1 != 3
    
    # çœŸå½å€¤
    assert True
    assert not False
    
    # None
    assert None is None
    assert 1 is not None
    
    # å¤§å°æ¯”è¼ƒ
    assert 5 > 3
    assert 3 < 5
    assert 5 >= 5
    assert 3 <= 3
```

### ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®assert

```python
def test_collections():
    """ãƒªã‚¹ãƒˆãƒ»è¾æ›¸ãªã©ã®æ¤œè¨¼"""
    
    # ãƒªã‚¹ãƒˆã®è¦ç´ ãƒã‚§ãƒƒã‚¯
    numbers = [1, 2, 3, 4, 5]
    assert 3 in numbers
    assert 6 not in numbers
    
    # ãƒªã‚¹ãƒˆã®é•·ã•
    assert len(numbers) == 5
    
    # ãƒªã‚¹ãƒˆã®ç­‰ä¾¡æ€§
    assert numbers == [1, 2, 3, 4, 5]
    
    # è¾æ›¸ã®ã‚­ãƒ¼ãƒã‚§ãƒƒã‚¯
    user = {"name": "ç”°ä¸­", "age": 30}
    assert "name" in user
    assert user["name"] == "ç”°ä¸­"
    
    # ã‚»ãƒƒãƒˆã®æ¤œè¨¼
    tags = {"python", "test", "pytest"}
    assert "python" in tags
```

### æ–‡å­—åˆ—ã®assert

```python
def test_strings():
    """æ–‡å­—åˆ—ã®æ¤œè¨¼"""
    
    text = "Hello, pytest!"
    
    # å«ã¾ã‚Œã‚‹ã‹
    assert "pytest" in text
    
    # å‰æ–¹ä¸€è‡´
    assert text.startswith("Hello")
    
    # å¾Œæ–¹ä¸€è‡´
    assert text.endswith("!")
    
    # å¤§æ–‡å­—å°æ–‡å­—
    assert text.lower() == "hello, pytest!"
    
    # ç©ºæ–‡å­—åˆ—ãƒã‚§ãƒƒã‚¯
    assert "" == ""
    assert bool("") == False
```

### æµ®å‹•å°æ•°ç‚¹ã®assert

```python
def test_floats():
    """æµ®å‹•å°æ•°ç‚¹ã®æ¤œè¨¼ï¼ˆè¿‘ä¼¼æ¯”è¼ƒï¼‰"""
    
    # âŒ ã“ã‚Œã¯å¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹
    # assert 0.1 + 0.2 == 0.3
    
    # âœ… pytest.approx ã‚’ä½¿ã†
    import pytest
    assert 0.1 + 0.2 == pytest.approx(0.3)
    
    # è¨±å®¹èª¤å·®ã‚’æŒ‡å®š
    assert 0.333333 == pytest.approx(1/3, abs=1e-6)
    
    # ç›¸å¯¾èª¤å·®
    assert 100.1 == pytest.approx(100, rel=0.01)
```

### ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```python
def test_with_message():
    """ã‚¨ãƒ©ãƒ¼æ™‚ã«ã‚ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º"""
    
    result = 10
    expected = 10
    
    # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä»˜ãassert
    assert result == expected, f"æœŸå¾…å€¤: {expected}, å®Ÿéš›: {result}"
    
    # ã‚ˆã‚Šè©³ç´°ã«
    numbers = [1, 2, 3]
    assert len(numbers) == 3, \
        f"ãƒªã‚¹ãƒˆã®é•·ã•ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚æœŸå¾…: 3, å®Ÿéš›: {len(numbers)}"
```

---

## ğŸš¨ ä¾‹å¤–ãƒ†ã‚¹ãƒˆ

### åŸºæœ¬çš„ãªä¾‹å¤–ãƒ†ã‚¹ãƒˆ

```python
import pytest

def test_exception():
    """ä¾‹å¤–ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚’ç¢ºèª"""
    
    # ValueError ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚’æœŸå¾…
    with pytest.raises(ValueError):
        int("not a number")
    
    # ZeroDivisionError ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚’æœŸå¾…
    with pytest.raises(ZeroDivisionError):
        1 / 0
```

### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ¤œè¨¼

```python
def divide(a, b):
    """å‰²ã‚Šç®—ï¼ˆ0ã§å‰²ã‚Œãªã„ï¼‰"""
    if b == 0:
        raise ValueError("0ã§å‰²ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“")
    return a / b


def test_divide_by_zero():
    """ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚ç¢ºèª"""
    
    # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä¸€éƒ¨ã‚’ç¢ºèª
    with pytest.raises(ValueError, match="0ã§å‰²ã‚‹"):
        divide(10, 0)
    
    # å®Œå…¨ä¸€è‡´
    with pytest.raises(ValueError, match="^0ã§å‰²ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“$"):
        divide(5, 0)
```

### ä¾‹å¤–ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å–å¾—

```python
def test_exception_details():
    """ä¾‹å¤–ã®è©³ç´°æƒ…å ±ã‚’å–å¾—"""
    
    # ä¾‹å¤–ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—
    with pytest.raises(ValueError) as exc_info:
        raise ValueError("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")
    
    # ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
    assert "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ" in str(exc_info.value)
    
    # ä¾‹å¤–ã®å‹ã‚’ç¢ºèª
    assert exc_info.type == ValueError
```

### ä¾‹å¤–ãŒç™ºç”Ÿã—ãªã„ã“ã¨ã‚’ç¢ºèª

```python
def test_no_exception():
    """æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª"""
    
    # ä¾‹å¤–ãŒç™ºç”Ÿã—ãªã‘ã‚Œã°OK
    result = divide(10, 2)
    assert result == 5.0
    
    # does_not_raise ã‚’ä½¿ã†æ–¹æ³•ï¼ˆæ˜ç¤ºçš„ï¼‰
    from pytest import does_not_raise
    
    with does_not_raise():
        divide(20, 4)
```

---

## ğŸ”§ ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£

ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã¯ã€ãƒ†ã‚¹ãƒˆã®å‰å‡¦ç†ãƒ»å¾Œå‡¦ç†ã‚’å®šç¾©ã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚

### åŸºæœ¬çš„ãªãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£

```python
import pytest

@pytest.fixture
def sample_data():
    """ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’æä¾›"""
    # ãƒ†ã‚¹ãƒˆå‰ã«å®Ÿè¡Œã•ã‚Œã‚‹ï¼ˆsetUpï¼‰
    data = [1, 2, 3, 4, 5]
    print("\n[setUp] ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™ã—ã¾ã—ãŸ")
    
    # ãƒ†ã‚¹ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™
    return data


def test_with_fixture(sample_data):
    """ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ä½¿ã†ãƒ†ã‚¹ãƒˆ"""
    # sample_data ãŒè‡ªå‹•ã§æ¸¡ã•ã‚Œã‚‹
    assert len(sample_data) == 5
    assert sum(sample_data) == 15
```

### å‰å‡¦ç†ãƒ»å¾Œå‡¦ç†ã®ã‚ã‚‹ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£

```python
@pytest.fixture
def database_connection():
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ»ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"""
    # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆãƒ†ã‚¹ãƒˆå‰ï¼‰
    print("\n[setUp] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶š")
    db = {"connected": True, "data": []}
    
    # ãƒ†ã‚¹ãƒˆã«æ¸¡ã™
    yield db
    
    # ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆãƒ†ã‚¹ãƒˆå¾Œï¼‰
    print("\n[tearDown] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’åˆ‡æ–­")
    db["connected"] = False
    db["data"].clear()


def test_database(database_connection):
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ã†ãƒ†ã‚¹ãƒˆ"""
    # database_connection ãŒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ¸ˆã¿
    assert database_connection["connected"] == True
    database_connection["data"].append("test")
    assert len(database_connection["data"]) == 1
```

### ã‚¹ã‚³ãƒ¼ãƒ—ï¼ˆæœ‰åŠ¹ç¯„å›²ï¼‰

```python
# é–¢æ•°ã”ã¨ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
@pytest.fixture(scope="function")
def function_scope():
    """å„ãƒ†ã‚¹ãƒˆé–¢æ•°ã”ã¨ã«å®Ÿè¡Œ"""
    return "function"


# ã‚¯ãƒ©ã‚¹ã”ã¨
@pytest.fixture(scope="class")
def class_scope():
    """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã”ã¨ã«1å›å®Ÿè¡Œ"""
    return "class"


# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã”ã¨
@pytest.fixture(scope="module")
def module_scope():
    """ãƒ•ã‚¡ã‚¤ãƒ«ã”ã¨ã«1å›å®Ÿè¡Œ"""
    return "module"


# ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨ä½“ã§1å›
@pytest.fixture(scope="session")
def session_scope():
    """å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã«1å›ã ã‘å®Ÿè¡Œ"""
    return "session"
```

### conftest.pyï¼ˆãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã®å…±æœ‰ï¼‰

```python
# tests/conftest.py
"""ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã§ä½¿ãˆã‚‹ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’å®šç¾©"""

import pytest

@pytest.fixture
def sample_user():
    """ã‚µãƒ³ãƒ—ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æä¾›"""
    return {
        "id": 1,
        "name": "ç”°ä¸­å¤ªéƒ",
        "email": "tanaka@example.com"
    }


@pytest.fixture
def temp_file(tmp_path):
    """ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ"""
    # tmp_path ã¯ pytestãŒæä¾›ã™ã‚‹çµ„ã¿è¾¼ã¿ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
    file = tmp_path / "test.txt"
    file.write_text("ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿")
    return file
```

```python
# tests/test_user.py
"""conftest.pyã®ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ã‚’ä½¿ãˆã‚‹"""

def test_user_name(sample_user):
    """sample_user ã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸è¦ã§ä½¿ãˆã‚‹"""
    assert sample_user["name"] == "ç”°ä¸­å¤ªéƒ"


def test_file_content(temp_file):
    """temp_file ã‚‚ä½¿ãˆã‚‹"""
    content = temp_file.read_text()
    assert content == "ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿"
```

### çµ„ã¿è¾¼ã¿ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£

```python
def test_temp_directory(tmp_path):
    """ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª"""
    # tmp_path ã¯è‡ªå‹•ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã•ã‚Œã‚‹
    file = tmp_path / "test.txt"
    file.write_text("Hello")
    assert file.read_text() == "Hello"


def test_temp_dir_legacy(tmpdir):
    """ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆãƒ¬ã‚¬ã‚·ãƒ¼ç‰ˆï¼‰"""
    # tmp_path ã®æ–¹ãŒæ¨å¥¨
    pass


def test_capture_output(capsys):
    """æ¨™æº–å‡ºåŠ›ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£"""
    print("Hello, World!")
    captured = capsys.readouterr()
    assert captured.out == "Hello, World!\n"


def test_monkeypatch(monkeypatch):
    """ç’°å¢ƒå¤‰æ•°ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¸€æ™‚çš„ã«å¤‰æ›´"""
    # ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
    monkeypatch.setenv("TEST_VAR", "test_value")
    import os
    assert os.getenv("TEST_VAR") == "test_value"
```

---

## ğŸ”„ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ãƒ†ã‚¹ãƒˆ

åŒã˜ãƒ†ã‚¹ãƒˆã‚’è¤‡æ•°ã®å…¥åŠ›å€¤ã§å®Ÿè¡Œã™ã‚‹

### åŸºæœ¬çš„ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–

```python
import pytest

@pytest.mark.parametrize("a, b, expected", [
    (1, 2, 3),      # 1 + 2 = 3
    (5, 5, 10),     # 5 + 5 = 10
    (-1, 1, 0),     # -1 + 1 = 0
    (0, 0, 0),      # 0 + 0 = 0
])
def test_add(a, b, expected):
    """è¤‡æ•°ã®ã‚±ãƒ¼ã‚¹ã‚’ä¸€åº¦ã«ãƒ†ã‚¹ãƒˆ"""
    result = a + b
    assert result == expected
```

**å®Ÿè¡Œçµæœï¼š**
```
test_add[1-2-3] PASSED
test_add[5-5-10] PASSED
test_add[-1-1-0] PASSED
test_add[0-0-0] PASSED
```

### ã‚ã‹ã‚Šã‚„ã™ã„ãƒ†ã‚¹ãƒˆå

```python
@pytest.mark.parametrize("a, b, expected", [
    pytest.param(1, 2, 3, id="æ­£ã®æ•°"),
    pytest.param(-1, 1, 0, id="è² ã®æ•°"),
    pytest.param(0, 0, 0, id="ã‚¼ãƒ­"),
])
def test_add_with_id(a, b, expected):
    """ãƒ†ã‚¹ãƒˆåã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º"""
    assert a + b == expected
```

**å®Ÿè¡Œçµæœï¼š**
```
test_add_with_id[æ­£ã®æ•°] PASSED
test_add_with_id[è² ã®æ•°] PASSED
test_add_with_id[ã‚¼ãƒ­] PASSED
```

### è¤‡æ•°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®çµ„ã¿åˆã‚ã›

```python
@pytest.mark.parametrize("x", [1, 2, 3])
@pytest.mark.parametrize("y", [10, 20])
def test_multiply(x, y):
    """å…¨çµ„ã¿åˆã‚ã›ã‚’ãƒ†ã‚¹ãƒˆï¼ˆ1Ã—10, 1Ã—20, 2Ã—10...ï¼‰"""
    result = x * y
    assert result == x * y
    # 6ã¤ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã‚‹ï¼ˆ3 Ã— 2ï¼‰
```

### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ– + ä¾‹å¤–ãƒ†ã‚¹ãƒˆ

```python
@pytest.mark.parametrize("value, exception", [
    ("abc", ValueError),
    ("12.34.56", ValueError),
    ("", ValueError),
])
def test_invalid_int_conversion(value, exception):
    """ç„¡åŠ¹ãªå€¤ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ã‚’ç¢ºèª"""
    with pytest.raises(exception):
        int(value)
```

---

## ğŸ·ï¸ ãƒãƒ¼ã‚«ãƒ¼

ãƒ†ã‚¹ãƒˆã‚’åˆ†é¡ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹

### åŸºæœ¬çš„ãªãƒãƒ¼ã‚«ãƒ¼

```python
import pytest

@pytest.mark.slow
def test_slow_operation():
    """æ™‚é–“ãŒã‹ã‹ã‚‹ãƒ†ã‚¹ãƒˆ"""
    import time
    time.sleep(2)
    assert True


@pytest.mark.unit
def test_unit():
    """å˜ä½“ãƒ†ã‚¹ãƒˆ"""
    assert 1 + 1 == 2


@pytest.mark.integration
def test_integration():
    """çµ±åˆãƒ†ã‚¹ãƒˆ"""
    assert True


@pytest.mark.smoke
def test_smoke():
    """ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆï¼ˆé‡è¦ãªæ©Ÿèƒ½ï¼‰"""
    assert True
```

**å®Ÿè¡Œæ–¹æ³•ï¼š**
```bash
# slowãƒãƒ¼ã‚«ãƒ¼ã®ã¿å®Ÿè¡Œ
pytest -m slow

# slowä»¥å¤–ã‚’å®Ÿè¡Œ
pytest -m "not slow"

# unitãƒãƒ¼ã‚«ãƒ¼ã®ã¿
pytest -m unit

# è¤‡æ•°ãƒãƒ¼ã‚«ãƒ¼
pytest -m "unit or integration"
```

### çµ„ã¿è¾¼ã¿ãƒãƒ¼ã‚«ãƒ¼

```python
import sys
import pytest

@pytest.mark.skip(reason="ã¾ã å®Ÿè£…ã—ã¦ã„ãªã„")
def test_not_implemented():
    """ã“ã®ãƒ†ã‚¹ãƒˆã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹"""
    assert False


@pytest.mark.skipif(sys.platform == "win32", 
                   reason="Windowsã§ã¯å‹•ä½œã—ãªã„")
def test_unix_only():
    """æ¡ä»¶ä»˜ãã‚¹ã‚­ãƒƒãƒ—"""
    assert True


@pytest.mark.xfail(reason="æ—¢çŸ¥ã®ãƒã‚°")
def test_known_bug():
    """å¤±æ•—ãŒäºˆæƒ³ã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆ"""
    assert 1 + 1 == 3  # ã‚ã–ã¨å¤±æ•—


@pytest.mark.xfail(strict=True)
def test_should_fail():
    """å¤±æ•—ã—ãªã„ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹"""
    assert False
```

### ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ã‚«ãƒ¼ã®å®šç¾©

```python
# pytest.ini
[pytest]
markers =
    api: APIãƒ†ã‚¹ãƒˆ
    database: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ
    critical: é‡è¦ãªãƒ†ã‚¹ãƒˆ
```

```python
# tests/test_custom.py
import pytest

@pytest.mark.api
def test_api_endpoint():
    """APIã®ãƒ†ã‚¹ãƒˆ"""
    assert True


@pytest.mark.database
def test_database_query():
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ"""
    assert True


@pytest.mark.critical
@pytest.mark.smoke
def test_critical_feature():
    """è¤‡æ•°ãƒãƒ¼ã‚«ãƒ¼ã‚’ä»˜ã‘ã‚‰ã‚Œã‚‹"""
    assert True
```

---

## ğŸ­ ãƒ¢ãƒƒã‚¯ãƒ»ãƒ‘ãƒƒãƒ

å¤–éƒ¨ä¾å­˜ã‚’ãƒ¢ãƒƒã‚¯åŒ–ã™ã‚‹

### pytest-mockï¼ˆæ¨å¥¨ï¼‰

```python
# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# pip install pytest-mock

def fetch_user_from_api(user_id):
    """å¤–éƒ¨APIã‚’å‘¼ã¶é–¢æ•°ï¼ˆãƒ†ã‚¹ãƒˆã—ãŸããªã„ï¼‰"""
    import requests
    response = requests.get(f"https://api.example.com/users/{user_id}")
    return response.json()


def get_user_name(user_id):
    """ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®é–¢æ•°"""
    user = fetch_user_from_api(user_id)
    return user["name"]


def test_get_user_name(mocker):
    """ãƒ¢ãƒƒã‚¯ã‚’ä½¿ã£ã¦APIã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ"""
    # fetch_user_from_api ã‚’ãƒ¢ãƒƒã‚¯åŒ–
    mock_fetch = mocker.patch("__main__.fetch_user_from_api")
    
    # ãƒ¢ãƒƒã‚¯ã®æˆ»ã‚Šå€¤ã‚’è¨­å®š
    mock_fetch.return_value = {"id": 1, "name": "ç”°ä¸­"}
    
    # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    result = get_user_name(1)
    
    # æ¤œè¨¼
    assert result == "ç”°ä¸­"
    # fetch_user_from_api ãŒå‘¼ã°ã‚ŒãŸã‹ç¢ºèª
    mock_fetch.assert_called_once_with(1)
```

### æˆ»ã‚Šå€¤ã®ãƒ¢ãƒƒã‚¯

```python
def test_mock_return_value(mocker):
    """æˆ»ã‚Šå€¤ã‚’è¨­å®š"""
    mock_func = mocker.Mock(return_value=42)
    
    result = mock_func()
    assert result == 42
    
    # å‘¼ã³å‡ºã—å›æ•°ã‚’ç¢ºèª
    assert mock_func.call_count == 1


def test_mock_side_effect(mocker):
    """è¤‡æ•°å›å‘¼ã³å‡ºã—ã§ç•°ãªã‚‹å€¤ã‚’è¿”ã™"""
    mock_func = mocker.Mock(side_effect=[1, 2, 3])
    
    assert mock_func() == 1
    assert mock_func() == 2
    assert mock_func() == 3


def test_mock_exception(mocker):
    """ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹"""
    mock_func = mocker.Mock(side_effect=ValueError("ã‚¨ãƒ©ãƒ¼"))
    
    with pytest.raises(ValueError):
        mock_func()
```

### ã‚¯ãƒ©ã‚¹ã®ãƒ¢ãƒƒã‚¯

```python
class Database:
    def connect(self):
        """å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šï¼ˆé¿ã‘ãŸã„ï¼‰"""
        pass
    
    def query(self, sql):
        """SQLã‚’å®Ÿè¡Œ"""
        pass


def test_database_mock(mocker):
    """ã‚¯ãƒ©ã‚¹å…¨ä½“ã‚’ãƒ¢ãƒƒã‚¯åŒ–"""
    # Database ã‚¯ãƒ©ã‚¹ã‚’ãƒ¢ãƒƒã‚¯
    mock_db = mocker.Mock(spec=Database)
    
    # ãƒ¡ã‚½ãƒƒãƒ‰ã®æˆ»ã‚Šå€¤ã‚’è¨­å®š
    mock_db.query.return_value = [{"id": 1, "name": "test"}]
    
    # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    result = mock_db.query("SELECT * FROM users")
    
    # æ¤œè¨¼
    assert len(result) == 1
    assert result[0]["name"] == "test"
    
    # ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã°ã‚ŒãŸã‹ç¢ºèª
    mock_db.query.assert_called_once_with("SELECT * FROM users")
```

### ç’°å¢ƒå¤‰æ•°ã®ãƒ¢ãƒƒã‚¯

```python
def test_environment_variable(mocker):
    """ç’°å¢ƒå¤‰æ•°ã‚’ä¸€æ™‚çš„ã«å¤‰æ›´"""
    mocker.patch.dict("os.environ", {"API_KEY": "test_key"})
    
    import os
    assert os.getenv("API_KEY") == "test_key"
```

### æ™‚åˆ»ã®ãƒ¢ãƒƒã‚¯

```python
from datetime import datetime

def test_freeze_time(mocker):
    """ç¾åœ¨æ™‚åˆ»ã‚’å›ºå®š"""
    fixed_time = datetime(2025, 1, 1, 12, 0, 0)
    
    mocker.patch("datetime.datetime")
    datetime.now.return_value = fixed_time
    
    # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    # now = datetime.now()
    # assert now == fixed_time
```

---

## ğŸ¯ å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰

### åŸºæœ¬çš„ãªå®Ÿè¡Œ

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
pytest

# è©³ç´°è¡¨ç¤º
pytest -v

# ã•ã‚‰ã«è©³ç´°ï¼ˆå„ãƒ†ã‚¹ãƒˆã®å‡ºåŠ›ã‚‚è¡¨ç¤ºï¼‰
pytest -vv

# printæ–‡ã‚’è¡¨ç¤º
pytest -s

# è©³ç´° + printè¡¨ç¤º
pytest -sv
```

### ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæŒ‡å®š

```bash
# ç‰¹å®šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
pytest tests/

# ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«
pytest tests/test_calculator.py

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆé–¢æ•°
pytest tests/test_calculator.py::test_add

# ç‰¹å®šã®ã‚¯ãƒ©ã‚¹
pytest tests/test_calculator.py::TestCalculator

# ã‚¯ãƒ©ã‚¹å†…ã®ç‰¹å®šãƒ¡ã‚½ãƒƒãƒ‰
pytest tests/test_calculator.py::TestCalculator::test_add
```

### ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

```bash
# ãƒãƒ¼ã‚«ãƒ¼ã§çµã‚Šè¾¼ã¿
pytest -m slow              # slowãƒãƒ¼ã‚«ãƒ¼ã®ã¿
pytest -m "not slow"        # slowä»¥å¤–
pytest -m "unit or smoke"   # è¤‡æ•°ãƒãƒ¼ã‚«ãƒ¼

# åå‰ã§çµã‚Šè¾¼ã¿ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰
pytest -k "add"             # åå‰ã«"add"ã‚’å«ã‚€ãƒ†ã‚¹ãƒˆ
pytest -k "not slow"        # åå‰ã«"slow"ã‚’å«ã¾ãªã„

# å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆã®ã¿å†å®Ÿè¡Œ
pytest --lf                 # last-failed
pytest --ff                 # failed-firstï¼ˆå¤±æ•—ã‚’å…ˆã«ï¼‰

# æœ€åˆã®å¤±æ•—ã§åœæ­¢
pytest -x

# Nå€‹å¤±æ•—ã—ãŸã‚‰åœæ­¢
pytest --maxfail=3
```

### ã‚«ãƒãƒ¬ãƒƒã‚¸

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’æ¸¬å®š
pytest --cov=src tests/

# ã‚«ãƒãƒ¬ãƒƒã‚¸ + è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ
pytest --cov=src --cov-report=term-missing tests/

# HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
pytest --cov=src --cov-report=html tests/
# htmlcov/index.html ã‚’é–‹ã

# ã‚«ãƒãƒ¬ãƒƒã‚¸ã®æœ€ä½ãƒ©ã‚¤ãƒ³è¨­å®š
pytest --cov=src --cov-fail-under=80 tests/
```

### ä¸¦åˆ—å®Ÿè¡Œ

```bash
# pytest-xdist ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pytest-xdist

# è‡ªå‹•ã§ä¸¦åˆ—æ•°æ±ºå®š
pytest -n auto

# 4ãƒ—ãƒ­ã‚»ã‚¹ã§ä¸¦åˆ—å®Ÿè¡Œ
pytest -n 4
```

### ãã®ä»–ä¾¿åˆ©ã‚ªãƒ—ã‚·ãƒ§ãƒ³

```bash
# ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œæ™‚é–“ã‚’è¡¨ç¤º
pytest --durations=10       # é…ã„10å€‹ã‚’è¡¨ç¤º

# è­¦å‘Šã‚’è¡¨ç¤º
pytest -W all

# è©³ç´°ãªãƒˆãƒ¬ãƒ¼ã‚¹ãƒãƒƒã‚¯
pytest --tb=long            # è©³ç´°
pytest --tb=short           # çŸ­ãï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
pytest --tb=no              # ãƒˆãƒ¬ãƒ¼ã‚¹ãƒãƒƒã‚¯ãªã—

# çµæœã‚’JUnitXMLå½¢å¼ã§å‡ºåŠ›ï¼ˆCIç”¨ï¼‰
pytest --junitxml=report.xml

# ãƒ†ã‚¹ãƒˆã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿè¡Œã›ãšä¸€è¦§è¡¨ç¤ºï¼‰
pytest --collect-only

# ãƒ˜ãƒ«ãƒ—
pytest --help
```

---

## ğŸ“‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

### ãƒ‘ã‚¿ãƒ¼ãƒ³1ï¼šã‚·ãƒ³ãƒ—ãƒ«ï¼ˆå°è¦æ¨¡ï¼‰

```
my_project/
â”œâ”€â”€ calculator.py
â””â”€â”€ test_calculator.py
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2ï¼šsrc/testsåˆ†é›¢ï¼ˆæ¨å¥¨ï¼‰

```
my_project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ calculator.py
â”‚   â””â”€â”€ utils.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py          # å…±é€šãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
â”‚   â”œâ”€â”€ test_calculator.py
â”‚   â””â”€â”€ test_utils.py
â”œâ”€â”€ pytest.ini
â””â”€â”€ requirements.txt
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3ï¼šå¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

```
my_project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ endpoints.py
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ models.py
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ helpers.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py
â”‚   â”œâ”€â”€ unit/                # å˜ä½“ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ test_api.py
â”‚   â”‚   â””â”€â”€ test_database.py
â”‚   â”œâ”€â”€ integration/         # çµ±åˆãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ test_api_integration.py
â”‚   â””â”€â”€ fixtures/            # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
â”‚       â””â”€â”€ sample_data.json
â”œâ”€â”€ pytest.ini
â”œâ”€â”€ requirements.txt
â””â”€â”€ .github/
    â””â”€â”€ workflows/
        â””â”€â”€ test.yml         # CI/CDè¨­å®š
```

---

## ğŸ’¼ å®Ÿå‹™ã§ã‚ˆãä½¿ã†ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1ï¼šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ

```python
# conftest.py
import pytest
import sqlite3

@pytest.fixture(scope="module")
def db_connection():
    """ãƒ†ã‚¹ãƒˆç”¨DBã‚’ä½œæˆ"""
    # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    conn = sqlite3.connect(":
